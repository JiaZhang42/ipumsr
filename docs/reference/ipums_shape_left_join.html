<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Join data to geographic boundaries — ipums_shape_left_join • ipumsr</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>


<!-- docsearch -->
<script src="../docsearch.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.3/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous" />
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>



<meta property="og:title" content="Join data to geographic boundaries — ipums_shape_left_join" />
<meta property="og:description" content="Helpers for joining shape files downloaded from the IPUMS website to data from extracts.
Because of historical reasons, the attributes of (like variable type) of variables
in the shape files does not always match those in the data files." />
<meta property="og:image" content="http://tech.popdata.org/ipumsr/logo.png" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ipumsr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.4.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li>
  <a href="../articles/ipums.html">Intro</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/ipums.html">Introduction</a>
    </li>
    <li>
      <a href="../articles/value-labels.html">Value labels</a>
    </li>
    <li>
      <a href="../articles/ipums-geography.html">Geographic data in ipumsr</a>
    </li>
    <li>
      <a href="../articles/ipums-bigdata.html">Big IPUMS data</a>
    </li>
    <li class="divider"></li>
    <li>
      <a href="../articles/ipums-cps.html">CPS exercise</a>
    </li>
    <li>
      <a href="../articles/ipums-nhgis.html">NHGIS exercise</a>
    </li>
    <li>
      <a href="../articles/ipums-terra.html">IPUMS Terra exercise</a>
    </li>
    <li>
      <a href="https://ipums.org/exercises.shtml">More project exercises</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/mnpopcenter/ipumsr">
    <span class="fa fa-github"></span>
     
  </a>
</li>
<li>
  <a href="https://forum.ipums.org">
    <span class="fa fa-users"></span>
     
  </a>
</li>
<li>
  <a href="https://www.ipums.org/">
    <span class="fa fa-globe"></span>
     
  </a>
</li>
      </ul>
      
      <form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
        </div>
      </form>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Join data to geographic boundaries</h1>
    <small class="dont-index">Source: <a href='https://github.com/mnpopcenter/ipumsr/blob/master/R/shape_join.r'><code>R/shape_join.r</code></a></small>
    <div class="hidden name"><code>ipums_shape_left_join.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Helpers for joining shape files downloaded from the IPUMS website to data from extracts.
Because of historical reasons, the attributes of (like variable type) of variables
in the shape files does not always match those in the data files.</p>
    </div>

    <pre class="usage"><span class='fu'>ipums_shape_left_join</span>(
  <span class='no'>data</span>,
  <span class='no'>shape_data</span>,
  <span class='no'>by</span>,
  <span class='kw'>suffix</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>""</span>, <span class='st'>"SHAPE"</span>),
  <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>
)

<span class='fu'>ipums_shape_right_join</span>(
  <span class='no'>data</span>,
  <span class='no'>shape_data</span>,
  <span class='no'>by</span>,
  <span class='kw'>suffix</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>""</span>, <span class='st'>"SHAPE"</span>),
  <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>
)

<span class='fu'>ipums_shape_inner_join</span>(
  <span class='no'>data</span>,
  <span class='no'>shape_data</span>,
  <span class='no'>by</span>,
  <span class='kw'>suffix</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>""</span>, <span class='st'>"SHAPE"</span>),
  <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>
)

<span class='fu'>ipums_shape_full_join</span>(
  <span class='no'>data</span>,
  <span class='no'>shape_data</span>,
  <span class='no'>by</span>,
  <span class='kw'>suffix</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>""</span>, <span class='st'>"SHAPE"</span>),
  <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>data</th>
      <td><p>A dataset, usually one that has been aggregated to a geographic level.</p></td>
    </tr>
    <tr>
      <th>shape_data</th>
      <td><p>A shape file (loaded with <code><a href='read_ipums_sf.html'>read_ipums_sf</a></code> or <code>read_ipums_sp</code>)</p></td>
    </tr>
    <tr>
      <th>by</th>
      <td><p>A vector of variable names to join on. Like the dplyr join functions, named vectors
 indicate that the names are different between the data and shape file.
 shape files to load. Accepts a character vector specifying the file name, or
<code><a href='dplyr_select_style.html'>dplyr_select_style</a></code> conventions. Can load multiple shape files,
  which will be combined.</p></td>
    </tr>
    <tr>
      <th>suffix</th>
      <td><p>For variables that are found in both, but aren't joined on, a suffix
to put on the variables. Defaults to nothing for data variables and "_SHAPE" for
variables from the shape file.</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>I <code>TRUE</code>, will report information about geometries dropped in the merge.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>returns a sf or a SpatialPolygonsDataFrame depending on what was passed in.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># Note that these examples use NHGIS data so that they use the example data provided,</span>
<span class='co'># but the functions read_nhgis_sf/read_nhgis_sp perform this merge for you.</span>

<span class='no'>data</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='read_nhgis.html'>read_nhgis</a></span>(<span class='fu'><a href='ipums_example.html'>ipums_example</a></span>(<span class='st'>"nhgis0008_csv.zip"</span>))</div><div class='output co'>#&gt; Use of data from NHGIS is subject to conditions including that users should
#&gt; cite the data appropriately. Use command `ipums_conditions()` for more details.
#&gt; 
#&gt; 
#&gt; Reading data file...</div><div class='input'>
<span class='kw'>if</span> (<span class='fu'><a href='https://rdrr.io/r/base/library.html'>require</a></span>(<span class='no'>sf</span>)) {
  <span class='no'>sf</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='read_ipums_sf.html'>read_ipums_sf</a></span>(<span class='fu'><a href='ipums_example.html'>ipums_example</a></span>(<span class='st'>"nhgis0008_shape_small.zip"</span>))
  <span class='no'>data_sf</span> <span class='kw'>&lt;-</span> <span class='fu'>ipums_shape_inner_join</span>(<span class='no'>data</span>, <span class='no'>sf</span>, <span class='kw'>by</span> <span class='kw'>=</span> <span class='st'>"GISJOIN"</span>)
}</div><div class='output co'>#&gt; <span class='message'>Loading required package: sf</span></div><div class='output co'>#&gt; <span class='message'>Linking to GEOS 3.6.1, GDAL 2.2.3, PROJ 4.9.3</span></div><div class='output co'>#&gt; options:        ENCODING=latin1 
#&gt; Reading layer `US_pmsa_1990' from data source `C:\Users\derek\AppData\Local\Temp\Rtmpg1qS8L\file375c2f9d1521\US_pmsa_1990.shp' using driver `ESRI Shapefile'
#&gt; Simple feature collection with 71 features and 8 fields
#&gt; geometry type:  MULTIPOLYGON
#&gt; dimension:      XY
#&gt; bbox:           xmin: -2336182 ymin: -1247086 xmax: 2075339 ymax: 1476544
#&gt; proj4string:    +proj=aea +lat_1=29.5 +lat_2=45.5 +lat_0=37.5 +lon_0=-96 +x_0=0 +y_0=0 +datum=NAD83 +units=m +no_defs </div><div class='input'>
<span class='kw'>if</span> (<span class='fu'><a href='https://rdrr.io/r/base/library.html'>require</a></span>(<span class='no'>sp</span>) <span class='kw'>&amp;&amp;</span> <span class='fu'><a href='https://rdrr.io/r/base/library.html'>require</a></span>(<span class='no'>rgdal</span>)) {
  <span class='no'>sp</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='read_ipums_sf.html'>read_ipums_sp</a></span>(<span class='fu'><a href='ipums_example.html'>ipums_example</a></span>(<span class='st'>"nhgis0008_shape_small.zip"</span>))
  <span class='no'>data_sp</span> <span class='kw'>&lt;-</span> <span class='fu'>ipums_shape_inner_join</span>(<span class='no'>data</span>, <span class='no'>sp</span>, <span class='kw'>by</span> <span class='kw'>=</span> <span class='st'>"GISJOIN"</span>)
}</div><div class='output co'>#&gt; <span class='message'>Loading required package: sp</span></div><div class='output co'>#&gt; <span class='message'>Loading required package: rgdal</span></div><div class='output co'>#&gt; <span class='message'>rgdal: version: 1.4-8, (SVN revision 845)</span>
#&gt; <span class='message'> Geospatial Data Abstraction Library extensions to R successfully loaded</span>
#&gt; <span class='message'> Loaded GDAL runtime: GDAL 2.2.3, released 2017/11/20</span>
#&gt; <span class='message'> Path to GDAL shared files: C:/Users/derek/Documents/R/win-library/4.0/rgdal/gdal</span>
#&gt; <span class='message'> GDAL binary built with GEOS: TRUE </span>
#&gt; <span class='message'> Loaded PROJ.4 runtime: Rel. 4.9.3, 15 August 2016, [PJ_VERSION: 493]</span>
#&gt; <span class='message'> Path to PROJ.4 shared files: C:/Users/derek/Documents/R/win-library/4.0/rgdal/proj</span>
#&gt; <span class='message'> Linking to sp version: 1.4-1 </span></div><div class='output co'>#&gt; OGR data source with driver: ESRI Shapefile 
#&gt; Source: "C:\Users\derek\AppData\Local\Temp\Rtmpg1qS8L\file375cc6d42de", layer: "US_pmsa_1990"
#&gt; with 71 features
#&gt; It has 8 fields</div><div class='input'>
<span class='kw'>if</span> (<span class='fl'>FALSE</span>) {
  <span class='co'># Sometimes variable names won't match between datasets (for example in IPUMS international)</span>
  <span class='no'>data</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='read_ipums_micro.html'>read_ipums_micro</a></span>(<span class='st'>"ipumsi_00004.xml"</span>)
  <span class='no'>shape</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='read_ipums_sf.html'>read_ipums_sf</a></span>(<span class='st'>"geo2_br1980_2010.zip"</span>)
  <span class='no'>data_sf</span> <span class='kw'>&lt;-</span> <span class='fu'>ipums_shape_inner_join</span>(<span class='no'>data</span>, <span class='no'>shape</span>, <span class='kw'>by</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"GEO2"</span> <span class='kw'>=</span> <span class='st'>"GEOLEVEL2"</span>))
}</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by <a href="https://www.ipums.org">IPUMS</a> at the University of Minnesota.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script>
<script>
  docsearch({
    
    
    apiKey: '4ffa912ace97d2493f6ed39f20e94316',
    indexName: 'ipumsr',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>



  </body>
</html>


