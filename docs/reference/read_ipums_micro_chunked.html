<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Read data from an IPUMS extract (in chunks) — read_ipums_micro_chunked • ipumsr</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><!-- docsearch --><script src="../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.3/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous"><link href="../docsearch.css" rel="stylesheet"><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><meta property="og:title" content="Read data from an IPUMS extract (in chunks) — read_ipums_micro_chunked"><meta property="og:description" content="Reads a dataset downloaded from the IPUMS extract system, but does
so by reading a chunk, then applying your code to that chunk and
then continuing, which can allow you to deal with data that is
too large to store in your computer's RAM all at once."><meta property="og:image" content="http://tech.popdata.org/ipumsr/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ipumsr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.5.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li>
  <a href="../articles/ipums.html">Intro</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/ipums.html">Introduction</a>
    </li>
    <li>
      <a href="../articles/value-labels.html">Value labels</a>
    </li>
    <li>
      <a href="../articles/ipums-geography.html">Geographic data in ipumsr</a>
    </li>
    <li>
      <a href="../articles/ipums-bigdata.html">Big IPUMS data</a>
    </li>
    <li>
      <a href="../articles/ipums-api.html">IPUMS data extract API</a>
    </li>
    <li class="divider">
    <li>
      <a href="../articles/ipums-cps.html">CPS exercise</a>
    </li>
    <li>
      <a href="../articles/ipums-nhgis.html">NHGIS exercise</a>
    </li>
    <li>
      <a href="../articles/ipums-terra.html">IPUMS Terra exercise</a>
    </li>
    <li>
      <a href="https://ipums.org/exercises.shtml" class="external-link">More project exercises</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/ipums/ipumsr" class="external-link">
    <span class="fa fa-github"></span>
     
  </a>
</li>
<li>
  <a href="https://forum.ipums.org" class="external-link">
    <span class="fa fa-users"></span>
     
  </a>
</li>
<li>
  <a href="https://www.ipums.org/" class="external-link">
    <span class="fa fa-globe"></span>
     
  </a>
</li>
      </ul><form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off"></div>
      </form>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Read data from an IPUMS extract (in chunks)</h1>
    <small class="dont-index">Source: <a href="https://github.com/ipums/ipumsr/blob/HEAD/R/micro_read_chunked.r" class="external-link"><code>R/micro_read_chunked.r</code></a></small>
    <div class="hidden name"><code>read_ipums_micro_chunked.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Reads a dataset downloaded from the IPUMS extract system, but does
so by reading a chunk, then applying your code to that chunk and
then continuing, which can allow you to deal with data that is
too large to store in your computer's RAM all at once.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">read_ipums_micro_chunked</span><span class="op">(</span>
  <span class="va">ddi</span>,
  <span class="va">callback</span>,
  chunk_size <span class="op">=</span> <span class="fl">10000</span>,
  vars <span class="op">=</span> <span class="cn">NULL</span>,
  data_file <span class="op">=</span> <span class="cn">NULL</span>,
  verbose <span class="op">=</span> <span class="cn">TRUE</span>,
  var_attrs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"val_labels"</span>, <span class="st">"var_label"</span>, <span class="st">"var_desc"</span><span class="op">)</span>,
  lower_vars <span class="op">=</span> <span class="cn">FALSE</span>
<span class="op">)</span>

<span class="fu">read_ipums_micro_list_chunked</span><span class="op">(</span>
  <span class="va">ddi</span>,
  <span class="va">callback</span>,
  chunk_size <span class="op">=</span> <span class="fl">10000</span>,
  vars <span class="op">=</span> <span class="cn">NULL</span>,
  data_file <span class="op">=</span> <span class="cn">NULL</span>,
  verbose <span class="op">=</span> <span class="cn">TRUE</span>,
  var_attrs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"val_labels"</span>, <span class="st">"var_label"</span>, <span class="st">"var_desc"</span><span class="op">)</span>,
  lower_vars <span class="op">=</span> <span class="cn">FALSE</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>ddi</dt>
<dd><p>Either a filepath to a DDI xml file downloaded from
the website, or a <code>ipums_ddi</code> object parsed by <code><a href="read_ipums_ddi.html">read_ipums_ddi</a></code></p></dd>


<dt>callback</dt>
<dd><p>An <code><a href="ipums_callback.html">ipums_callback</a></code> object, or a function
that will be converted to an IpumsSideEffectCallback object.</p></dd>


<dt>chunk_size</dt>
<dd><p>An integer indicating how many observations to
read in per chunk (defaults to 10,000). Setting this higher
uses more RAM, but will usually be faster.</p></dd>


<dt>vars</dt>
<dd><p>Names of variables to load. Accepts a character vector of names, or
<code><a href="dplyr_select_style.html">dplyr_select_style</a></code> conventions. For hierarchical data, the
rectype id variable will be added even if it is not specified.</p></dd>


<dt>data_file</dt>
<dd><p>Specify a directory to look for the data file.
If left empty, it will look in the same directory as the DDI file.</p></dd>


<dt>verbose</dt>
<dd><p>Logical, indicating whether to print progress information
to console.</p></dd>


<dt>var_attrs</dt>
<dd><p>Variable attributes to add from the DDI, defaults to
adding all (val_labels, var_label and var_desc). See
<code><a href="set_ipums_var_attributes.html">set_ipums_var_attributes</a></code> for more details.</p></dd>


<dt>lower_vars</dt>
<dd><p>Only if reading a DDI from a file, a logical indicating
whether to convert variable names to lowercase (default is FALSE, in line
with IPUMS conventions). Note that this argument will be ignored if
argument <code>ddi</code> is an <code>ipums_ddi</code> object rather than a file path.
See <code><a href="read_ipums_ddi.html">read_ipums_ddi</a></code> for converting variable names to lowercase
when reading in the DDI. Also note that if reading in chunks from a .csv or
.csv.gz file, the callback function will be called *before* variable names
are converted to lowercase, and thus should reference uppercase variable
names.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>Depends on the callback object</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p>Other ipums_read: 
<code><a href="read_ipums_micro_yield.html">read_ipums_micro_yield</a>()</code>,
<code><a href="read_ipums_micro.html">read_ipums_micro</a>()</code>,
<code><a href="read_ipums_sf.html">read_ipums_sf</a>()</code>,
<code><a href="read_nhgis.html">read_nhgis</a>()</code>,
<code><a href="read_terra_area.html">read_terra_area</a>()</code>,
<code><a href="read_terra_micro.html">read_terra_micro</a>()</code>,
<code><a href="read_terra_raster.html">read_terra_raster</a>()</code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="co"># Select Minnesotan cases from CPS example (Note you can also accomplish</span></span>
<span class="r-in"><span class="co"># this and avoid having to even download a huge file using the "Select Cases"</span></span>
<span class="r-in"><span class="co"># functionality of the IPUMS extract system)</span></span>
<span class="r-in"><span class="va">mn_only</span> <span class="op">&lt;-</span> <span class="fu">read_ipums_micro_chunked</span><span class="op">(</span></span>
<span class="r-in">  <span class="fu"><a href="ipums_example.html">ipums_example</a></span><span class="op">(</span><span class="st">"cps_00006.xml"</span><span class="op">)</span>,</span>
<span class="r-in">  <span class="va"><a href="ipums_callback.html">IpumsDataFrameCallback</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">pos</span><span class="op">)</span> <span class="op">{</span></span>
<span class="r-in">    <span class="va">x</span><span class="op">[</span><span class="va">x</span><span class="op">$</span><span class="va">STATEFIP</span> <span class="op">==</span> <span class="fl">27</span>, <span class="op">]</span></span>
<span class="r-in">  <span class="op">}</span><span class="op">)</span>,</span>
<span class="r-in">  chunk_size <span class="op">=</span> <span class="fl">1000</span> <span class="co"># Generally you want this larger, but this example is a small file</span></span>
<span class="r-in"><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Use of data from IPUMS-CPS is subject to conditions including that users should</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cite the data appropriately. Use command `ipums_conditions()` for more details.</span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Tabulate INCTOT average by state without storing full dataset in memory</span></span>
<span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Attaching package: 'dplyr'</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The following objects are masked from 'package:stats':</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     filter, lag</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The following objects are masked from 'package:base':</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     intersect, setdiff, setequal, union</span>
<span class="r-in"><span class="va">inc_by_state</span> <span class="op">&lt;-</span> <span class="fu">read_ipums_micro_chunked</span><span class="op">(</span></span>
<span class="r-in">  <span class="fu"><a href="ipums_example.html">ipums_example</a></span><span class="op">(</span><span class="st">"cps_00006.xml"</span><span class="op">)</span>,</span>
<span class="r-in">  <span class="va"><a href="ipums_callback.html">IpumsDataFrameCallback</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">pos</span><span class="op">)</span> <span class="op">{</span></span>
<span class="r-in">    <span class="va">x</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span class="r-in">      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span class="r-in">        INCTOT <span class="op">=</span> <span class="fu"><a href="lbl_na_if.html">lbl_na_if</a></span><span class="op">(</span></span>
<span class="r-in">          <span class="va">INCTOT</span>, <span class="op">~</span><span class="va">.lbl</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Missing."</span>, <span class="st">"N.I.U. (Not in Universe)."</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in">        <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span class="r-in">      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">INCTOT</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span class="r-in">      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span>STATEFIP <span class="op">=</span> <span class="fu"><a href="https://forcats.tidyverse.org/reference/as_factor.html" class="external-link">as_factor</a></span><span class="op">(</span><span class="va">STATEFIP</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span class="r-in">      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span>INCTOT_SUM <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">INCTOT</span><span class="op">)</span>, n <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span>, .groups <span class="op">=</span> <span class="st">"drop"</span><span class="op">)</span></span>
<span class="r-in">  <span class="op">}</span><span class="op">)</span>,</span>
<span class="r-in">  chunk_size <span class="op">=</span> <span class="fl">1000</span> <span class="co"># Generally you want this larger, but this example is a small file</span></span>
<span class="r-in"><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span class="r-in"><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">STATEFIP</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span class="r-in"><span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span>avg_inc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">INCTOT_SUM</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Use of data from IPUMS-CPS is subject to conditions including that users should</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cite the data appropriately. Use command `ipums_conditions()` for more details.</span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># x will be a list when using `read_ipums_micro_list_chunked()`</span></span>
<span class="r-in"><span class="fu">read_ipums_micro_list_chunked</span><span class="op">(</span></span>
<span class="r-in">  <span class="fu"><a href="ipums_example.html">ipums_example</a></span><span class="op">(</span><span class="st">"cps_00010.xml"</span><span class="op">)</span>,</span>
<span class="r-in">  <span class="va"><a href="ipums_callback.html">IpumsSideEffectCallback</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">pos</span><span class="op">)</span> <span class="op">{</span></span>
<span class="r-in">    <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">PERSON</span><span class="op">)</span>, <span class="st">" persons and "</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">HOUSEHOLD</span><span class="op">)</span>, <span class="st">" households in this chunk."</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in">  <span class="op">}</span><span class="op">)</span>,</span>
<span class="r-in">  chunk_size <span class="op">=</span> <span class="fl">1000</span> <span class="co"># Generally you want this larger, but this example is a small file</span></span>
<span class="r-in"><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Use of data from IPUMS-CPS is subject to conditions including that users should</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cite the data appropriately. Use command `ipums_conditions()` for more details.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "699 persons and 301 households in this chunk."</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "701 persons and 299 households in this chunk."</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "693 persons and 307 households in this chunk."</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "685 persons and 315 households in this chunk."</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "696 persons and 304 households in this chunk."</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "691 persons and 309 households in this chunk."</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "695 persons and 305 households in this chunk."</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "691 persons and 309 households in this chunk."</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "694 persons and 306 households in this chunk."</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "692 persons and 308 households in this chunk."</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "692 persons and 308 households in this chunk."</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "39 persons and 14 households in this chunk."</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Using the biglm package, you can even run a regression without storing</span></span>
<span class="r-in"><span class="co"># the full dataset in memory</span></span>
<span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span class="r-in"><span class="kw">if</span> <span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va">biglm</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span class="r-in">  <span class="va">lm_results</span> <span class="op">&lt;-</span> <span class="fu">read_ipums_micro_chunked</span><span class="op">(</span></span>
<span class="r-in">    <span class="fu"><a href="ipums_example.html">ipums_example</a></span><span class="op">(</span><span class="st">"cps_00015.xml"</span><span class="op">)</span>,</span>
<span class="r-in">    <span class="va"><a href="ipums_callback.html">IpumsBiglmCallback</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span>
<span class="r-in">      <span class="va">INCTOT</span> <span class="op">~</span> <span class="va">AGE</span> <span class="op">+</span> <span class="va">HEALTH</span>, <span class="co"># Simple regression (may not be very useful)</span></span>
<span class="r-in">      <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">pos</span><span class="op">)</span> <span class="op">{</span></span>
<span class="r-in">        <span class="va">x</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span class="r-in">        <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span class="r-in">          INCTOT <span class="op">=</span> <span class="fu"><a href="lbl_na_if.html">lbl_na_if</a></span><span class="op">(</span></span>
<span class="r-in">            <span class="va">INCTOT</span>, <span class="op">~</span><span class="va">.lbl</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Missing."</span>, <span class="st">"N.I.U. (Not in Universe)."</span><span class="op">)</span></span>
<span class="r-in">          <span class="op">)</span>,</span>
<span class="r-in">          HEALTH <span class="op">=</span> <span class="fu"><a href="https://forcats.tidyverse.org/reference/as_factor.html" class="external-link">as_factor</a></span><span class="op">(</span><span class="va">HEALTH</span><span class="op">)</span></span>
<span class="r-in">        <span class="op">)</span></span>
<span class="r-in">    <span class="op">}</span><span class="op">)</span>,</span>
<span class="r-in">    chunk_size <span class="op">=</span> <span class="fl">1000</span> <span class="co"># Generally you want this larger, but this example is a small file</span></span>
<span class="r-in">  <span class="op">)</span></span>
<span class="r-in">  <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">lm_results</span><span class="op">)</span></span>
<span class="r-in"><span class="op">}</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required package: biglm</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required package: DBI</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Use of data from IPUMS-CPS is subject to conditions including that users should</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> cite the data appropriately. Use command `ipums_conditions()` for more details.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Large data regression model: biglm(INCTOT ~ AGE + HEALTH, data, ...)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sample size =  8194 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                        Coef        (95%        CI)        SE      p</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)      25351.6183  21728.2210  28975.016 1811.6986 0.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AGE                499.7783    427.5196    572.037   36.1293 0.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HEALTHVery good  -2135.1060  -5431.8110   1161.599 1648.3525 0.1952</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HEALTHGood      -10480.2543 -14052.9835  -6907.525 1786.3646 0.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HEALTHFair      -23091.1061 -28274.2254 -17907.987 2591.5596 0.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HEALTHPoor      -34341.0066 -42611.9852 -26070.028 4135.4893 0.0000</span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p>Developed by <a href="https://www.ipums.org" class="external-link">IPUMS</a> at the University of Minnesota.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> .</p>
</div>

      </footer></div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({
    
    
    apiKey: '4ffa912ace97d2493f6ed39f20e94316',
    indexName: 'ipumsr',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script></body></html>

